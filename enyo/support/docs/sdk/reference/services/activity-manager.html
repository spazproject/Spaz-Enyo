<!DOCTYPE html>
<html>
	<head>
		<title>$if(pagetitle)$$pagetitle$$endif$</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="_css/chrome.css" />
		<link rel="stylesheet" href="../_css/chrome.css" />
		<link rel="stylesheet" href="../../_css/chrome.css" />
		<link rel="stylesheet" href="../../../_css/chrome.css" />
		<script src="_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="_js/doc.js" type="text/javascript"></script>
		<script src="../_js/doc.js" type="text/javascript"></script>
		<script src="../../_js/doc.js" type="text/javascript"></script>
		<script src="../../../_js/doc.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="content">
    
    <h1 id="activity-manager">
      Activity Manager
    </h1>
    <p>
      You can call Activity Manager methods asynchronously through the <code>serviceRequest</code> function, which takes two parameters:
    </p>
    <ul>
      <li>The Activity Manager <a href="http://en.wikipedia.org/wiki/URI">URI</a> (Uniform Resource Identifier)
      </li>
      <li>A <a href="http://en.wikipedia.org/wiki/JSON">JSON</a> (JavaScript Object Notation) object containing parameters, callback functions, and other data.
      </li>
    </ul>
    <p>
      For example:
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;complete&quot;,
   parameters: {
                 &quot;activityId&quot;: 876
   },
   onSuccess: function(){ Mojo.Log.info(&quot;complete success&quot;); },
   onFailure: function(){ Mojo.Log.info(&quot;complete failure&quot;); }
});
</code>
</pre>
    <p>
      You can also use the new Foundation library API for calling Palm services. Palm's JavaScript Foundation libraries are a loadable framework that both Mojo and JavaScript service applications can use.
    </p>
    <p>
      For example:
    </p>
    <pre>
var libraries = MojoLoader.require({ name: "foundations", version: "1.0" });
var PalmCall = libraries["foundations"].Comms.PalmCall;
PalmCall.call("palm://com.palm.activitymanager/", "addFocus", {"srcActivityID": 876, "targetActivityID": 345 });
</pre>
    <p>
      Using Foundations also requires your app to have the following two tags in your index.html file:
    </p>
    <pre>
&lt;script src="/usr/palm/frameworks/mojo/mojo.js" type="text/javascript" x-mojo-version="1"&gt;&lt;/script&gt; 
&lt;script src="/usr/palm/frameworks/mojoloader.js" type="text/javascript"&gt;&lt;/script&gt;
</pre>
    <p>
      Depending on outcome, both calls return a JSON result indicating success or failure. Your code can then parse the result. Your app needs to take into account the call's asynchronous nature (results may be delayed) and not block user interaction while awaiting results.
    </p>
    <p>
      For more information on calling services such as the Activity Manager, see <a href="http://developer.palm.com/index.php?option=com_content&view=article&id=1649&Itemid=20">Services Overiew</a> and <a href="http://developer.palm.com/index.php?option=com_content&view=article&id=1651&Itemid=240">Services API</a>.
    </p>
    <h2 id="about-json">
      About JSON
    </h2>
    <p>
      JSON is a lightweight data-interchange text format based on a subset of the JavaScript programming language that is easy for humans to read and write and for machines to parse and generate. Like XML, JSON contains name/value pair collections and ordered list of values (i.e., arrays).
    </p>
    <p>
      For more information on JSON, see the following websites:
    </p>
    <ul>
      <li>JSON objects, values and format—<a href="http://www.json.org/" target="_blank">http://www.json.org/</a>
      </li>
      <li>JSON schemas—<a href="http://tools.ietf.org/html/draft-zyp-json-schema-02" target="_blank">http://tools.ietf.org/html/draft-zyp-json-schema-02</a>
      </li>
    </ul>
    <p>
      A primer on how JSON data objects are formatted is beyond the scope of this document—consult the two links above for more information. However, in brief:
    </p>
    <ul>
      <li>Curly brackets ('{', '}') are used to enclose objects.
      </li>
      <li>Angle brackets ('[', ']') are used to enclose arrays.
      </li>
      <li>Colons (':') are used as delimiters in name/value pairs.
      </li>
      <li>Quotes (&quot;) are used for string values. Numeric values are not quoted.
      </li>
    </ul>
    <h2 id="activity-manager-public-methods">
      Activity Manager Public Methods
    </h2>
    <table cellpadding="5" cellspacing="5" border="1">
      <thead>
        <tr bgcolor="tan">
          <th>
            Method
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <a href="#adopt">adopt</a>
          </td>
          <td>
            Adopt an Activity, registering willingness to take over as parent.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#cancel">cancel</a>
          </td>
          <td>
            End an Activity immediately, allowing little or no time for clean-up.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#complete">complete</a>
          </td>
          <td>
            End an Activity with option to restart with new attributes.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#create">create</a>
          </td>
          <td>
            Create an Activity.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#getDetails">getDetails</a>
          </td>
          <td>
            Get details about an Activity, including associations.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#monitor">monitor</a>
          </td>
          <td>
            Get Activity state, with option to subscribe to future updates.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#release">release</a>
          </td>
          <td>
            Allows parent to end an Activity, allowing time for adopters to take over as the parent and let the Activity continue.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#start">start</a>
          </td>
          <td>
            Starts an Activity, with an option to force it to run.
          </td>
        </tr>
        <tr>
          <td>
            <a href="#stop">stop</a>
          </td>
          <td>
            End an Activity, allowing some time for clean-up.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <a name="adopt" id="adopt">&#160;</a>
    </p>
    <hr>
    <h2 id="adopt">
      adopt
    </h2>
    <p>
      Registers an app's or service's willingness to take over as the Activity's parent.
    </p>
    <p>
      If your app can wait for an unavailable <a href="/reference/data-types/activity-manager.html#Activity">Activity</a> (not <a href="#release">released</a>) to become available, then set the <code>&quot;wait&quot;</code> flag to <code>true</code>. If it is, and the Activity is valid (exists and is not exiting), the call should succeed. If it cannot wait, and the Activity is valid but cannot be adopted, then the call fails. The <code>adopted</code> return flag indicates a successful or failed adoption.
    </p>
    <p>
      If not immediately adopted and waiting is requested, the &quot;orphan&quot; event informs the adopter that they are the new Activity parent.
    </p>
    <p>
      An example where adoption makes sense is an app that allocates a separate Activity for a sync, and passes that Activity to a service to use. The service should adopt the Activity and be ready to take over in the event the app exits before the service is done syncing. Otherwise, it receives a &quot;cancel&quot; event and should exit immediately. The service should wait until the <a href="#adopt">adopt</a> (or <a href="#monitor">monitor</a>) call returns successfully before beginning Activity work. If <code>adopt</code> or <code>monitor</code> fails, it indicates the caller has quit or closed the Activity and the request should not be processed. The Service should continue to process incoming events on their subscription to the Activity.
    </p>
    <p>
      If the service did not call <code>adopt</code> to indicate to the Activity Manager its willingness to take over as the parent, it should be prepared to stop work for the Activity and unsubscribe if it receives a &quot;cancel&quot; event. Otherwise, if it receives the &quot;orphan&quot; event indicating the parent has unsubscribed and the service is now the parent, then it should use <a href="#complete">complete</a> when finished to inform the Activity Manager before unsubscribing.
    </p>
    <h3 id="syntax">
      Syntax
    </h3>
    <blockquote>
      <pre>
<code>{
  &quot;activityId&quot;     : int | &quot;activityName&quot; : string,
  &quot;wait&quot;           : boolean,
  &quot;subscribe&quot;      : boolean,
  &quot;detailedEvents&quot; : boolean
}
</code>
</pre>
    </blockquote>
    <h3 id="parameters">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this, or &quot;activityName&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this, or &quot;activityId&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            wait
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            Wait for Activity to be released flag.
          </td>
        </tr>
        <tr>
          <td>
            subscribe
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            Flag to subscribe to Activity and receive Activity events.
          </td>
        </tr>
        <tr>
          <td>
            detailedEvents
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            Flag to have the Activity Manager generate &quot;update&quot; events when the state of an Activity's requirement changes.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            adopted
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (adopted) or <code>false</code> (not adopted)
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;adopt&quot;,
   parameters: {
                 &quot;activityId&quot;     : 876,
                 &quot;wait&quot;           : true,
                 &quot;subscribe&quot;      : true,
                 &quot;detailedEvents&quot; : false                                 
   },
   onSuccess: function(e){ Mojo.Log.info(&quot;adopt success, adopted=&quot;+e.adopted); },
   onFailure: function(e){ Mojo.Log.info(&quot;adopt failure&quot;); }
});
</code>
</pre>
    <p>
      <a name="cancel" id="cancel">&#160;</a>
    </p>
    <hr>
    <h2 id="cancel">
      cancel
    </h2>
    <p>
      Terminates the specified <a href="/reference/data-types/activity-manager.html#Activity">Activity</a> and sends a &quot;cancel&quot; event to all subscribers. This call should succeed if the Activity exists and is not already exiting.
    </p>
    <p>
      This is different from the <a href="#stop">stop</a> method in that the Activity should take little or no time to clean up. For example, this might matter for an email sync service that needs more time to finish downloading a large email attachment. On a &quot;cancel&quot;, it should immediately abort the download, clean up, and exit. On a &quot;stop&quot;, it should finish downloading the attachment in some reasonable amount of time, say, 10-15 seconds. Note, however, that specific time limits are not currently enforced, though this could change.
    </p>
    <h3 id="syntax-1">
      Syntax
    </h3>
    <blockquote>
      <pre>
<code>{
  &quot;activityId&quot;  : int | &quot;activityName&quot; : string
}
</code>
</pre>
    </blockquote>
    <h3 id="parameter">
      Parameter
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this, or &quot;activityName&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this, or &quot;activityId&quot; is required.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-1">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;cancel&quot;,
   parameters: {&quot;activityId&quot;: 17},
   onSuccess: function(e) { Mojo.Log.info(&quot;cancel success&quot;);},
   onFailure: function(e) { Mojo.Log.info(&quot;cancel failure&quot;);}
});
</code>
</pre>
    <p>
      <a name="complete" id="complete">&#160;</a>
    </p>
    <hr>
    <h2 id="complete">
      complete
    </h2>
    <p>
      An Activity's parent can use this method to end the <a href="/reference/data-types/activity-manager.html#Activity">Activity</a> and optionally restart it with new attributes. If there are other subscribers, they are sent a &quot;complete&quot; event.
    </p>
    <p>
      If <code>restart</code> is requested, the Activity is optionally updated with any new <a href="/reference/data-types/activity-manager.html#Callbacks">Callback</a>, <a href="/reference/data-types/activity-manager.html#Schedule">Schedule</a>, <a href="/reference/data-types/activity-manager.html#Requirements">Requirements</a>, or <a href="/reference/data-types/activity-manager.html#Triggers">Trigger</a> data and returned to the queued state. Specifying <code>false</code> for any of those properties removes the property completely. For any properties not specified, current properties are used.
    </p>
    <p>
      If the Activity is persistent (specified with the <code>persist</code> flag in the <a href="/reference/data-types/activity-manager.html#Type">Type</a> object), the db8 database is updated before the call returns.
    </p>
    <h3 id="syntax-2">
      Syntax
    </h3>
    <pre>
    {
        "activityId"   : int | "activityName" : string,
        "restart"      : boolean, 
        "callback"     : false | Callback,  
        "schedule"     : false | Schedule, 
        "requirements" : false | Requirements,  
        "trigger"      : false | Triggers,  
        "metadata:     : false | any object
    }
</pre>
    <h3 id="parameters-1">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this, or &quot;activityName&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this, or &quot;activityId&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            restart
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Restart Activity flag. Default is false.
          </td>
        </tr>
        <tr>
          <td>
            callback
          </td>
          <td>
            No
          </td>
          <td>
            boolean or Callback
          </td>
          <td>
            Callback to use if Activity is restarted.
          </td>
        </tr>
        <tr>
          <td>
            schedule
          </td>
          <td>
            No
          </td>
          <td>
            boolean or Schedule
          </td>
          <td>
            Schedule to use if Activity is restarted.
          </td>
        </tr>
        <tr>
          <td>
            requirements
          </td>
          <td>
            No
          </td>
          <td>
            boolean or Requirements
          </td>
          <td>
            Prerequisites to use if Activity is restarted.
          </td>
        </tr>
        <tr>
          <td>
            trigger
          </td>
          <td>
            No
          </td>
          <td>
            boolean or Trigger
          </td>
          <td>
            Trigger to use if Activity is restarted.
          </td>
        </tr>
        <tr>
          <td>
            metadata
          </td>
          <td>
            No
          </td>
          <td>
            boolean or any object
          </td>
          <td>
            Meta data
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-2">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;complete&quot;,
   parameters: {
                 &quot;activityId&quot;: 876
   },
   onSuccess: function(){ Mojo.Log.info(&quot;complete success&quot;); },
   onFailure: function(){ Mojo.Log.info(&quot;complete failure&quot;); }
});
</code>
</pre>
    <p>
      <a name="create" id="create">&#160;</a>
    </p>
    <hr>
    <h2 id="create">
      create
    </h2>
    <p>
      Creates a new <a href="/reference/data-types/activity-manager.html#Activity">Activity</a> and returns its ID.
    </p>
    <p>
      You can create either a foreground or background Activity. A foreground Activity is run as soon as its specified prerequisites are met. After a background Activity's prerequisites are met, it is moved into a ready queue, and a limited number are allowed to run depending on system resources. Foreground is the default.
    </p>
    <p>
      Activities can be <a href="/reference/data-types/activity-manager.html#Schedule">scheduled</a> to run at a specific time or when certain <a href="/reference/data-types/activity-manager.html#Requirements">conditions</a> are met or events occur.
    </p>
    <p>
      Each of your created and owned Activities must have a unique name. To replace one of your existing Activities, set the <code>&quot;replace&quot;</code> flag to <code>true</code>. This cancels the original Activity and replaces it with the new Activity.
    </p>
    <p>
      To keep an Activity alive and receive status updates, the parent (and adopters, if any) must set the <code>&quot;subscribe&quot;</code> flag to <code>true</code>. Otherwise, if the Activity is created with a callback and <code>&quot;subscribe=false&quot;</code>, the Activity must be <a href="#adopt">adopted</a> immediately after the callback is invoked for the Activity to continue.
    </p>
    <p>
      To indicate the Activity is fully-initialized and ready to launch, set the <code>&quot;start&quot;</code> flag to <code>true</code>. Activities with a callback should be started when created—the callback is invoked when the prerequisites have been met and, in the case of a background, non-immediate Activity, it has been cleared to run.
    </p>
    <p>
      <strong>When requirements are not initially met</strong>
    </p>
    <p>
      If the creator of the Activity also specifies &quot;subscribe&quot;:true, and detailed events are enabled for that subscription, then the Activity Manager will generate either an immediate &quot;start&quot; event if the requirements are met, or an &quot;update&quot; event if the Activity is not yet ready to start due to missing requirements, schedule, or trigger. This allows the creating Service to determine if it should continue executing while waiting for the callback, or exit to free memory if it may be awhile before the Activity is ready to run.
    </p>
    <h3 id="syntax-3">
      Syntax
    </h3>
    <pre>
{
    "activity"       : Activity,
    "subscribe"      : boolean,
    "detailedEvents" : boolean,     
    "start"          : boolean,
    "replace"        : boolean
}
</pre>
    <h3 id="parameters-2">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activity
          </td>
          <td>
            Yes
          </td>
          <td>
            object
          </td>
          <td>
            Activity object
          </td>
        </tr>
        <tr>
          <td>
            subscribe
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Subscribe to Activity flag.
          </td>
        </tr>
        <tr>
          <td>
            detailedEvents
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Flag to have the Activity Manager generate &quot;update&quot; events when the state of one of this Activity's requirements changes.
          </td>
        </tr>
        <tr>
          <td>
            start
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Start Activity immediately flag.
          </td>
        </tr>
        <tr>
          <td>
            replace
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Cancel Activity and replace with Activity of same name flag.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-3">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            activityId
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Examples</strong>
    </p>
    <p>
      <strong>In this section:</strong>
    </p>
    <ul>
      <li>
        <a href="#createActivty">Create an Activity</a>
      </li>
      <li>
        <a href="#createSchedActivity">Create a Scheduled Activity</a>
      </li>
      <li>
        <a href="#createTrigActivity">Create a Triggered Activity</a>
      </li>
      <li>
        <a href="#createActivityCallback">Create an Activity with a Trigger and a Callback</a>
      </li>
      <li>
        <a href="#createTrigActivityDB8">Create an Activity with a Keyed Trigger Based on a db8 Watch</a>
      </li>
    </ul>
    <p>
      <a name="createActivty" id="createActivty">&#160;</a>
    </p>
    <p>
      <strong>Create an Activity</strong>
    </p>
    <p>
      Create an Activity with a given name and description.
    </p>
    <pre>
<code>   this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
      method: &quot;create&quot;,
      parameters: {       
         &quot;activity&quot;: {
                       &quot;name&quot;: &quot;basicactivity&quot;,
                       &quot;description&quot;: &quot;Test create&quot;,
                        &quot;type&quot;: {
                                   &quot;foreground&quot;: true
                                 }
                      },

                 &quot;start&quot;: true,
                 &quot;subscribe&quot;:true
          },
      onSuccess: function(e) { Mojo.Log.info(&quot;create success, activity=&quot;+JSON.stringify(e.activityId));},
      onFailure: function(e) { Mojo.Log.info(&quot;create failure, err=&quot;+JSON.stringify(e));}
   }); 
</code>
</pre>
    <p>
      <a name="createSchedActivity" id="createSchedActivity">&#160;</a>
    </p>
    <p>
      <strong>Create a Scheduled Activity</strong>
    </p>
    <p>
      This creates an Activity that receives a &quot;start&quot; event on the subscription when the specified time is reached. The Activity is started as part of the create command.
    </p>
    <pre>
<code>   this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
      method: &quot;create&quot;,
      parameters: {       
         &quot;activity&quot;: {
            &quot;name&quot;: &quot;ScheduledActivity&quot;,
            &quot;description&quot;: &quot;Test create of scheduled activity&quot;,
            &quot;type&quot;: {
                      &quot;foreground&quot;: true
                    }
          },
          &quot;schedule&quot; : { &quot;start&quot; : &quot;2010-05-27 13:22:00&quot; },

          &quot;start&quot;: true,
           &quot;subscribe&quot;:true
      },
      onSuccess: function(e) { Mojo.Log.info(&quot;create Scheduled Activity success, activity=&quot;+JSON.stringify(e));},
      onFailure: function(e) { Mojo.Log.info(&quot;create Scheduled Activity failure, err=&quot;+JSON.stringify(e) );}
   });
</code>
</pre>
    <p>
      <a name="createTrigActivity" id="createTrigActivity">&#160;</a>
    </p>
    <p>
      <strong>Create a Triggered Activity</strong>
    </p>
    <p>
      The following is an example of a basic Triggered Activity. The trigger is based on the connection status changing. An easy way to change the status is to switch into and out of airplane mode. After the initial success result, the second result causes the Trigger to fire.
    </p>
    <pre>
<code>  this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
     method: &quot;create&quot;,
     parameters: {       
                   &quot;activity&quot;: {
                                  &quot;name&quot;: &quot;triggeredActivity&quot;,
                                  &quot;description&quot;: &quot;Test create Activity with Trigger&quot;,
                                  &quot;type&quot;: {
                                            &quot;background&quot;: true
                                          },
                                 &quot;trigger&quot; : {
                                                &quot;method&quot; : &quot;palm://com.palm.connectionmanager/getStatus&quot;, 
                                                &quot;params&quot; : {&quot;subscribe&quot;:true}
                                             }
                               },
                   &quot;start&quot;:     true,
                   &quot;subscribe&quot;: true
                  },
     onSuccess: function(e) { Mojo.Log.info(&quot;Activity with Trigger success, return=&quot;+JSON.stringify(e));},
     onFailure: function(e) { Mojo.Log.info(&quot;Activity with Trigger failure&quot;);}
  }); 
</code>
</pre>
    <p>
      <a name="createActivityCallback" id="createActivityCallback">&#160;</a>
    </p>
    <p>
      <strong>Create an Activity with a Trigger and a Callback</strong>
    </p>
    <p>
      The following example creates an Activity with a trigger and a callback. The trigger occurs when the device's connection status changes. When this occurs, the callback is invoked and the device's email service is launched to send an email.
    </p>
    <pre>
<code>  this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
  method: &quot;create&quot;,
  parameters: {       
                &quot;activity&quot;: {
                &quot;name&quot;: &quot;triggeredActivity&quot;,
                &quot;description&quot; : &quot;Example triggered Activity&quot;,
                &quot;type&quot;: {  &quot;background&quot;: true },
                &quot;trigger&quot; : {
                               &quot;method&quot; : &quot;palm://com.palm.connectionmanager/getStatus&quot;,  // Device status service
                               &quot;params&quot; : {&quot;subscribe&quot;:true}
                            },
                &quot;callback&quot; : {
                                &quot;method&quot; : &quot;palm://com.palm.applicationManager/open&quot;, // Launch email service via app manager service
                                &quot;params&quot; : { id: &quot;com.palm.app.email&quot;,  // Send email
                                             params: {
                                                        summary: &quot;test subject&quot;,
                                                        text: &quot;Test email text.&quot;,
                                                        recipients: [{
                                                                       type: &quot;email&quot;,
                                                                       role: 1,
                                                                       value:&quot;Hal.Itosis@palm.com&quot;,
                                                                       contactDisplay: &quot;Ginger Vitis&quot; }]
                                                      }                                                                                                 
                                             }
                              }                                                                                           
              },
              &quot;start&quot;      : true  // Start immediately
            },
     onSuccess: function(e) { Mojo.Log.info(&quot;Activity with Trigger and Callback success, return=&quot;+JSON.stringify(e));},
     onFailure: function(e) { Mojo.Log.info(&quot;Activity with Trigger  and Callback failure&quot;);}
  }); 
</code>
</pre>
    <p>
      <a name="createTrigActivityDB8" id="createTrigActivityDB8">&#160;</a>
    </p>
    <p>
      <strong>Create an Activity with a Keyed Trigger Based on a db8 Watch</strong>
    </p>
    <p>
      This example creates an activity with a keyed trigger and a callback. The trigger is based on a db8 watch method and query. If the results of the query change, the watch method invokes the callback function. The Activity Manager looks for the &quot;fired&quot; keyed property in the results that are returned. The query contains two where clauses indicating a specific account and a revision (_rev) field. The revision is a counter that is incremented every time a db8 JSON object changes and is stored with the object.
    </p>
    <p>
      See the db8 documentation for more information on formatting queries.
    </p>
    <pre>
<code>  this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
     method: &quot;create&quot;,
     parameters: {       
                   &quot;activity&quot;: { 
                               &quot;callback&quot;: { &quot;method&quot;: &quot;palm://com.palm.myservice/userEdit&quot; }, 
                               &quot;description&quot;: &quot;my db watch&quot;, 
                                &quot;name&quot;: &quot;My DbWatch&quot;, 
                                &quot;trigger&quot;: { 
                                             &quot;key&quot;: &quot;fired&quot;, 
                                             &quot;method&quot;: &quot;palm://com.palm.db/watch&quot;, 
                                             &quot;params&quot;: { 
                                                         &quot;query&quot;: { 
                                                                    &quot;from&quot;: &quot;com.palm.contact:1&quot;, 
                                                                    &quot;where&quot;: [ 
                                                                                { &quot;prop&quot;: &quot;accountId&quot;, &quot;op&quot;: &quot;=&quot;, &quot;val&quot;: &quot;21e2&quot; }, 
                                                                                { &quot;prop&quot;: &quot;_rev&quot;, &quot;op&quot;: &quot;&gt;&quot;, &quot;val&quot;: 11410 } 
                                                                              ], 
                                                                     &quot;incDel&quot;: true 
                                                                   } 
                                                       } 
                                             }, 
                                &quot;type&quot;: { &quot;background&quot;: true, &quot;persist&quot;: true }, 
                                &quot;requirements&quot;: { &quot;idle&quot;: 30 }                                                          
                             },
                  &quot;start&quot;: true 
     }, 
     onSuccess: function(e) { Mojo.Log.info(&quot;Create Activity with db8 watch success, return=&quot;+JSON.stringify(e));},
     onFailure: function(e) { Mojo.Log.info(&quot;Create Activity with db8 watch failure, err=&quot;+JSON.stringify(e));}
  }); 
</code>
</pre>
    <p>
      <a name="getDetails" id="getDetails">&#160;</a>
    </p>
    <hr>
    <h2 id="getdetails">
      getDetails
    </h2>
    <p>
      Requests an Activity's full details, including associations.
    </p>
    <h3 id="syntax-4">
      Syntax
    </h3>
    <blockquote>
      <pre>
<code>{
  &quot;activityId&quot;  : int |  &quot;activityName&quot; : string
}
</code>
</pre>
    </blockquote>
    <h3 id="parameters-3">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this or activityName must be specified.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this or activityId must be specified.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-4">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
        <tr>
          <td>
            activity
          </td>
          <td>
            Activity
          </td>
          <td>
            Activity object including associations.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;getDetails&quot;,
   parameters: {
                 &quot;activityId&quot;: 3
   },
   onSuccess: function(e) { Mojo.Log.info(&quot;getDetails success, activity=&quot;+JSON.stringify(e.activity));},
   onFailure: function(e) { Mojo.Log.info(&quot;getActivity failure&quot;);}
});
</code>
</pre>
    <p>
      <a name="monitor" id="monitor">&#160;</a>
    </p>
    <hr>
    <h2 id="monitor">
      monitor
    </h2>
    <p>
      Given an activity ID, returns the current <a href="/reference/data-types/activity-manager.html#State">activity state</a>. If the caller chooses to subscribe, additional Activity status updates are returned as they occur.
    </p>
    <h3 id="syntax-5">
      Syntax
    </h3>
    <blockquote>
      <pre>
<code>{
  &quot;activityId&quot;     : int |  &quot;activityName&quot;   : string,
  &quot;subscribe&quot;      : boolean,
  &quot;detailedEvents&quot; : boolean
}
</code>
</pre>
    </blockquote>
    <h3 id="parameters-4">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this, or &quot;activityName&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this, or &quot;activityId&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            subscribe
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            Activity subscription flag.
          </td>
        </tr>
        <tr>
          <td>
            detailedEvents
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            Flag to have the Activity Manager generate &quot;update&quot; events when the state of one of this Activity's requirements changes.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-5">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            state
          </td>
          <td>
            string
          </td>
          <td>
            Activity state
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;monitor&quot;,
   parameters: {
                 &quot;activityId&quot;: 3,
                 &quot;subscribe&quot; : false,
                 &quot;detailedEvents&quot; : false
    },
    onSuccess: function(e) { Mojo.Log.info(&quot;Monitor success, state=&quot;+JSON.stringify(e.state));},
    onFailure: function(e) { Mojo.Log.info(&quot;Monitor failure&quot;);}
});
</code>
</pre>
    <p>
      <a name="release" id="release">&#160;</a>
    </p>
    <hr>
    <h2 id="release">
      release
    </h2>
    <p>
      Allows a parent to free an <a href="/reference/data-types/activity-manager.html#Activity">Activity</a> and notify other subscribers. The Activity is cancelled unless one of its non-parent subscribers <a href="#adopt">adopts</a> it and becomes the new parent. This has to happen in the <code>timeout</code> specified. If no <code>timeout</code> is specified, the Activity is cancelled immediately. For a completely safe transfer, a subscribing app or service, prior to the release, should already have called <code>adopt</code>, indicating its willingness to take over as the parent.
    </p>
    <h3 id="syntax-6">
      Syntax
    </h3>
    <blockquote>
      <pre>
<code>{
  &quot;activityId&quot;  : int | &quot;activityName&quot; : string,
  &quot;timeout&quot;     : int
}
</code>
</pre>
    </blockquote>
    <h3 id="parameters-5">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this or &quot;activityName&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this or &quot;activityId&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            timeout
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Time to wait, in seconds, for Activity to be adopted after release.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-6">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;release&quot;,
   parameters: {
                 &quot;activityId&quot; : 876,
                 &quot;timeout&quot;    : 30 
   },
   onSuccess: function(){ Mojo.Log.info(&quot;release success&quot;); },
   onFailure: function(){ Mojo.Log.info(&quot;release failure&quot;); }
});
</code>
</pre>
    <p>
      <a name="start" id="start">&#160;</a>
    </p>
    <hr>
    <h2 id="start">
      start
    </h2>
    <p>
      Attempts to start the specified <a href="/reference/data-types/activity-manager.html#Activity">Activity</a>, either moving it from the &quot;init&quot; state to be eligible to run, or resuming it if it is currently paused. This sends &quot;start&quot; events to any subscribed listeners once the Activity is cleared to begin. If the &quot;force&quot; parameter is present (and true), other Activities could be cancelled to free resources the Activity needs to run.
    </p>
    <h3 id="syntax-7">
      Syntax
    </h3>
    <blockquote>
      <pre>
<code>{
  &quot;activityId&quot;  : int | &quot;activityName&quot; : string,
  &quot;force&quot;       : boolean
}
</code>
</pre>
    </blockquote>
    <h3 id="parameters-6">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this or &quot;activityName&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this or &quot;activityId&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            force
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Force the Activity run flag. If &quot;true&quot;, other Activities could be cancelled to free resources the Activity needs to run.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-7">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <p>
      <a name="stop" id="stop">&#160;</a>
    </p>
    <hr>
    <h2 id="stop">
      stop
    </h2>
    <p>
      Stops an <a href="/reference/data-types/activity-manager.html#Activity">Activity</a> and sends a &quot;stop&quot; event to all Activity subscribers. This succeeds unless the Activity is already cancelled.
    </p>
    <p>
      This is different from the <a href="#cancel">cancel</a> method in that more time is allowed for the Activity to clean up. For example, this might matter for an email sync service that needs more time to finish downloading a large email attachment. On a &quot;cancel&quot;, it should immediately abort the download, clean up, and exit. On a &quot;stop,&quot; it should finish downloading the attachment in some reasonable amount of time--say, 10-15 seconds.
    </p>
    <h3 id="syntax-8">
      Syntax
    </h3>
    <blockquote>
      <pre>
<code>{
  &quot;activityId&quot;  : int | &quot;activityName&quot; : string
}
</code>
</pre>
    </blockquote>
    <h3 id="parameters-7">
      Parameters
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            activityId
          </td>
          <td>
            No
          </td>
          <td>
            int
          </td>
          <td>
            Activity ID. Either this or &quot;activityName&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            activityName
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Activity name. Either this or &quot;activityId&quot; is required.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-8">
      Returns
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.activitymanager/&quot;, {
   method: &quot;stop&quot;,
   parameters: {
                 &quot;activityId&quot;: 876
   },
   onSuccess: function(e){ Mojo.Log.info(&quot;stop success&quot;); },
   onFailure: function(e){ Mojo.Log.info(&quot;stop failure&quot;); }
});
</code>
</pre>
		</div>
	</body>
</html>
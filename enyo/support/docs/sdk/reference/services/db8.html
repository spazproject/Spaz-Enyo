<!DOCTYPE html>
<html>
	<head>
		<title>$if(pagetitle)$$pagetitle$$endif$</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="_css/chrome.css" />
		<link rel="stylesheet" href="../_css/chrome.css" />
		<link rel="stylesheet" href="../../_css/chrome.css" />
		<link rel="stylesheet" href="../../../_css/chrome.css" />
		<script src="_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="_js/doc.js" type="text/javascript"></script>
		<script src="../_js/doc.js" type="text/javascript"></script>
		<script src="../../_js/doc.js" type="text/javascript"></script>
		<script src="../../../_js/doc.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="content">
    
    <h1 id="db8-service-api">
      db8 Service API
    </h1>
    <table cellspacing="5" cellpadding="5" border="1">
      <tr bgcolor="tan">
        <th width="100">
          API
        </th>
        <th width="500">
          Description
        </th>
      </tr>
      <tr>
        <td>
          <a href="#batch">batch</a>
        </td>
        <td>
          Execute put, get, del, find (without a watch) and merge operations in one service request. All other database operations are not allowed. Atomicity is NOT guaranteed across batched operations.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#del">del</a>
        </td>
        <td>
          Deletes objects from the database. Objects can be specified using a query or array of object IDs.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#delKind">delKind</a>
        </td>
        <td>
          Deletes a JSON kind object from the database. All objects of that kind are also deleted.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#find">find</a>
        </td>
        <td>
          Finds objects matching a query.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#get">get</a>
        </td>
        <td>
          Gets objects by ID. Returns array of complete objects. Fastest way to get data from database storage.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#merge">merge</a>
        </td>
        <td>
          Updates properties in existing objects. Similar to SQL UPDATE. Objects can be specified using a query or array of object IDs.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#put">put</a>
        </td>
        <td>
          Writes JSON data objects to db8 storage.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#putKind">putKind</a>
        </td>
        <td>
          Puts a JSON kind object into the database. A kind object must be created before objects <em>of that kind</em> are stored.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#reserveIds">reserveIds</a>
        </td>
        <td>
          Reserves a block of object IDs.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#search">search</a>
        </td>
        <td>
          Searches for objects matching a query. Supports the &quot;?&quot; operator, which you can use for full-text searching.
        </td>
      </tr>
      <tr>
        <td>
          <a href="#watch">watch</a>
        </td>
        <td>
          Watch for updates to database that would change the results of a query.
        </td>
      </tr>
    </table><br>
    <p>
      <a name="batch" id="batch">&#160;</a>
    </p>
    <hr>
    <h2 id="batch">
      batch
    </h2>
    <p>
      Execute put, get, del, find (without a watch) and merge operations in one service request. All other database operations are not allowed. Atomicity is NOT guaranteed across batched operations.
    </p>
    <h3 id="schema">
      Schema
    </h3>
    <pre>
{
    "operations" : <a href="/reference/data-types/db8.html#BatchOperation">BatchOperation</a> array           
}
</pre>
    <h3 id="parameters">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            operations
          </td>
          <td>
            Yes
          </td>
          <td>
            <a href="/reference/data-types/db8.html#BatchOperation">BatchOperation</a> array
          </td>
          <td>
            Array of operations to perform in the batch.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Succcess: <a href="/reference/data-types/db8.html#BatchResponse">BatchResponse</a><br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <p>
      Batch with put, del, and find operations.
    </p>
    <pre>
<code> var operations = [{&quot;method&quot; : &quot;put&quot;,
                   &quot;params&quot; :{ &quot;objects&quot;: [{ &quot;_kind&quot;: &quot;com.palm.sample:1&quot;, &quot;displayName&quot;: &quot;Chester Fields&quot;, &quot;state&quot; : &quot;CA&quot;, 
                                               &quot;name&quot;: [{&quot;familyName&quot;:&quot;Fields&quot;, &quot;givenName&quot;:&quot;Chester&quot;}], &quot;nickname&quot;: &quot;Smokey&quot;,
                                               &quot;emails&quot;:[{&quot;value&quot;:&quot;cfields@gmail.com&quot;, &quot;type&quot;:&quot;home&quot;},
                                                       {&quot;value&quot;: &quot;chester.fields@palm.com&quot;, &quot;type&quot;:&quot;work&quot;}]}]
                             },
                   },
                   {&quot;method&quot;: &quot;del&quot;, &quot;params&quot;:{&quot;ids&quot;:[&quot;116d&quot;]}},
                   {&quot;method&quot;: &quot;find&quot;, &quot;params&quot;:{&quot;query&quot;:{&quot;from&quot;:&quot;com.palm.sample:1&quot;, &quot;where&quot;:[{&quot;prop&quot;:&quot;state&quot;,&quot;op&quot;:&quot;=&quot;,&quot;val&quot;:&quot;OR&quot;}]}}}
                 ];                                                                

  this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;batch&quot;,
        parameters: { &quot;operations&quot;: operations },
        onSuccess: function(e) { Mojo.Log.info(&quot;Batch success! results=&quot; + JSON.stringify(e));},
        onFailure: function(e) { Mojo.Log.info(&quot;Batch failure! Err = &quot; + JSON.stringify(e));}
 });
</code>
</pre>
    <p>
      <strong>Example Output</strong>
    </p>
    <pre>
<code>Batch success! 
results={
   &quot;returnValue&quot;:true,
   &quot;responses&quot;:[
      {
         &quot;returnValue&quot;:true,
         &quot;results&quot;:[
            {
               &quot;id&quot;:&quot;++HEHBh2FRWQsiSM&quot;,
               &quot;rev&quot;:4810
            }
         ]
      },
      {
         &quot;returnValue&quot;:true,
         &quot;results&quot;:[

         ]
      },
      {
         &quot;returnValue&quot;:true,
         &quot;results&quot;:[
            {
               &quot;_id&quot;:&quot;++HEDfsxCncIyLO8&quot;,
               &quot;_kind&quot;:&quot;com.palm.sample:1&quot;,
               &quot;_rev&quot;:4456,
               &quot;displayName&quot;:&quot;Helen Wheels&quot;,
               &quot;emails&quot;:[
                  {
                     &quot;_id&quot;:&quot;1169&quot;,
                     &quot;type&quot;:&quot;home&quot;,
                     &quot;value&quot;:&quot;hwheels@gmail.com&quot;
                  },
                  {
                     &quot;_id&quot;:&quot;116a&quot;,
                     &quot;type&quot;:&quot;work&quot;,
                     &quot;value&quot;:&quot;helen.wheels@palm.com&quot;
                  }
               ],
               &quot;name&quot;:[
                  {
                     &quot;_id&quot;:&quot;116b&quot;,
                     &quot;familyName&quot;:&quot;Wheels&quot;,
                     &quot;givenName&quot;:&quot;Helen&quot;
                  }
               ],
               &quot;nickname&quot;:&quot;Speedy&quot;,
               &quot;state&quot;:&quot;OR&quot;
            }
         ]
      }
   ]
}
</code>
</pre>
    <p>
      <a name="del" id="del">&#160;</a>
    </p>
    <hr>
    <h2 id="del">
      del
    </h2>
    <p>
      Deletes JSON data objects from the database.
    </p>
    <p>
      Objects can be specified as a set of IDs (returns PutResponse) or as a db8 Query (returns CountResponse).
    </p>
    <h3 id="schema-1">
      Schema
    </h3>
    <pre>
{
   "ids"   : string array,
   "query" : <a href="/reference/data-types/db8.html#Query">Query</a>,
   "purge" : boolean            
}
</pre>
    <h3 id="parameters-1">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            ids
          </td>
          <td>
            No
          </td>
          <td>
            string array
          </td>
          <td>
            Array of JSON data object IDs to delete. This or &quot;query&quot; must be specified.
          </td>
        </tr>
        <tr>
          <td>
            query
          </td>
          <td>
            No
          </td>
          <td>
            <a href="/reference/data-types/db8.html#Query">Query</a>
          </td>
          <td>
            Query specifying set of objects to delete. This or &quot;ids&quot; must be specified.
          </td>
        </tr>
        <tr>
          <td>
            purge
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Purge immediately flag. If not purged, target objects are marked as deleted and not completely removed until an administrative purge operation is run. Objects marked as deleted can still be retrieved. Default is false.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-1">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Succcess: <a href="/reference/data-types/db8.html#PutResponse">PutResponse</a> (IDs) or <a href="/reference/data-types/db8.html#CountResponse">CountResponse</a> (query)<br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Examples</strong>
    </p>
    <p>
      <strong>Example delete using ID</strong>
    </p>
    <pre>
<code>   var id1 = &quot;++HE8X59Y00hoKrF&quot;;
   var ids = [id1];
   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;del&quot;,
        parameters: { &quot;ids&quot;: ids },
        onSuccess: function(e) 
        { 
            Mojo.Log.info(&quot;del success!&quot;);
            Mojo.Log.info(&quot;del #1, id=&quot;+ e.results[0].id+&quot;, rev=&quot;+e.results[0].rev);                    
        },
        onFailure: function(e) { Mojo.Log.info(&quot;del failure! Err = &quot; + JSON.stringify(e));}
 });    
</code>
</pre>
    <p>
      <strong>Example delete using query</strong>
    </p>
    <pre>
<code>   var q = { &quot;from&quot;:&quot;com.palm.sample:1&quot;, &quot;where&quot;:[{&quot;prop&quot;:&quot;state&quot;,&quot;op&quot;:&quot;=&quot;,&quot;val&quot;:&quot;OR&quot;}] };
   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
      method: &quot;del&quot;,
      parameters: { &quot;query&quot;: q },
      onSuccess: function(e) { Mojo.Log.info(&quot;del success!, count=&quot;+e.count);},
      onFailure: function(e) { Mojo.Log.info(&quot;del failure! Err = &quot; + JSON.stringify(e));}
 });
</code>
</pre>
    <p>
      <a name="delKind" id="delKind">&#160;</a>
    </p>
    <hr>
    <h2 id="delkind">
      delKind
    </h2>
    <p>
      Deletes a kind object from the database. Deleting a kind deletes <strong>ALL</strong> data objects of that kind.
    </p>
    <h3 id="schema-2">
      Schema
    </h3>
    <pre>
{
   "id" : string
}
</pre>
    <h3 id="parameters-2">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            id
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            ID of kind to delete.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-2">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tbody>
        <tr>
          <td width="100">
            Response
          </td>
          <td>
            <a href="/reference/data-types/db8.html#SuccessResponse">SuccessResponse</a><br>
            or<br>
            <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>   var id = &quot;com.palm.sample:1&quot;; // kind + version number
     this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;delKind&quot;,
        parameters: { &quot;id&quot;: id },
        onSuccess: function(e) { Mojo.Log.info(&quot;delKind success!&quot;);},
        onFailure: function(e) { Mojo.Log.info(&quot;delKind failure! Err = &quot; + JSON.stringify(e));}
     }); 
</code>
</pre>
    <p>
      <a name="find" id="find">&#160;</a>
    </p>
    <hr>
    <h2 id="find">
      find
    </h2>
    <p>
      Returns a set of objects matching a <a href="/reference/data-types/db8.html#Query">query</a>.
    </p>
    <p>
      If your query is limited to a specified number of results, you can set a flag (&quot;count&quot;) to get the number that would have been returned without a limit. You can also set a flag (&quot;watch&quot;) to request notification if any of the returned results from the query changes in the future.
    </p>
    <h3 id="schema-3">
      Schema
    </h3>
    <pre>
{
   "query" : <a href="/reference/data-types/db8.html#Query">Query</a>,
   "count" : boolean,
   "watch" : boolean
}
</pre>
    <h3 id="parameters-3">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            query
          </td>
          <td>
            Yes
          </td>
          <td>
            <a href="/reference/data-types/db8.html#Query">Query</a>
          </td>
          <td>
            db8 query for retrieving results.
          </td>
        </tr>
        <tr>
          <td>
            count
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Return number of objects that would have been returned without the limit specified in the query flag. Default is false.
          </td>
        </tr>
        <tr>
          <td>
            watch
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Notify if change flag. Default is false.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-3">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tbody>
        <tr>
          <td width="100">
            Response
          </td>
          <td>
            Succcess: <a href="/reference/data-types/db8.html#FindResponse">FindResponse</a> or <a href="/reference/data-types/db8.html#NotificationResponse">NotificationResponse</a><br>
            (watch == true)<br>
            Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Examples</strong>
    </p>
    <p>
      <strong>Example 1: Simple find</strong>
    </p>
    <p>
      This query returns all data objects. No notification and no count is requested.
    </p>
    <pre>
<code>   var fquery = {&quot;from&quot;:&quot;com.palm.sample:1&quot;};

   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
      method: &quot;find&quot;,
      parameters: { &quot;query&quot;: fquery },
      onSuccess: function(e) { Mojo.Log.info(&quot;find success!, results=&quot;+JSON.stringify(e.results));},
      onFailure: function(e) { Mojo.Log.info(&quot;find failure! Err = &quot; + JSON.stringify(e));}
   });
</code>
</pre>
    <p>
      <strong>Example 2: Using where, select, order by, and desc in a query</strong>
    </p>
    <p>
      This query searches for contacts who live in California (state == 'CA'. The displayName and state fields are returned for each match. Returned objects are sorted on the displayName field in descending order. No notification is requested.
    </p>
    <pre>
<code> //**
 //** Note: A dual index for the kind was created, allowing this call to work:
 //**          var indexes = [{&quot;name&quot;:&quot;dNameState&quot;, props:[{&quot;name&quot;: &quot;state&quot;}, {&quot;name&quot;:&quot;displayName&quot;}]} ];
 //**
 //**       The query below will not work if 'displayName' is declared as the first 'props' entry and 'state' the second.
 //**       Results can only be returned for contiguously ordered index entries. If you have the entries [&quot;CA&quot;, &quot;John Doe&quot;], [&quot;CA&quot;,&quot;Mabel Syrup&quot;], etc.,
 //**       then, all of the entries with the same state are consecutive and only secondarily ordered by display name. Therefore, the index can answer the query.
 //**       If the index entries were ordered in [&quot;displayName&quot;, &quot;state&quot;] order, the entries for the same state are not consecutive and
 //**       could not be used to answer the query (the query would fail with a &quot;no index for query&quot; message).

   var fquery = {&quot;select&quot;: [&quot;displayName&quot;, &quot;state&quot;],
                 &quot;from&quot;:&quot;com.mystuff.contacts:1&quot;,
                 &quot;where&quot;:[{&quot;prop&quot;:&quot;state&quot;,&quot;op&quot;:&quot;=&quot;,&quot;val&quot;:&quot;CA&quot;}], 
                 &quot;orderBy&quot;:&quot;displayName&quot;,
                 &quot;desc&quot;:true };

   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;find&quot;,
        parameters: { &quot;query&quot;: fquery },
        onSuccess: function(e)        
        { 
           Mojo.Log.info(&quot;find success!&quot;);
           var results = e.results;
           for (i=0; results[i] != null; i++)
              Mojo.Log.info(&quot;find #&quot;+i+&quot;  state =&quot;+ results[i].state+&quot;, displayName=&quot;+results[i].displayName);                  
        },
        onFailure: function(e) { Mojo.Log.info(&quot;find failure! Err = &quot; + JSON.stringify(e));}
   }); 
</code>
</pre>
    <p>
      <strong>Example 3: Query with change notification</strong>
    </p>
    <p>
      This example shows how change notiification for a find works. The &quot;onSuccess&quot; code is called again if results for the initial query have changed. The &quot;fired&quot; flag is true if this is a notification response.
    </p>
    <pre>
<code>    var fquery = {&quot;select&quot;: [&quot;displayName&quot;, &quot;state&quot;],&quot;from&quot;:&quot;com.palm.sample:1&quot;};

   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;find&quot;,
        parameters: { &quot;query&quot;: fquery,
                      &quot;watch&quot;: true },
        onSuccess: function(e) 
        { 
          if (!e.fired)
          {
             Mojo.Log.info(&quot;find initial response success, e= &quot; + JSON.stringify(e));
          }
          else
          {
             Mojo.Log.info(&quot;find results changed&quot;);
             //
             // Do something, i.e., reissue find
             //
          }  
        },
        onFailure: function(e) { Mojo.Log.info(&quot;find failure! Err = &quot; + JSON.stringify(e));}
   }); 
</code>
</pre>
    <p>
      <a name="get" id="get">&#160;</a>
    </p>
    <hr>
    <h2 id="get">
      get
    </h2>
    <p>
      Gets JSON data objects by IDs. This is the fastest way to retrieve data.
    </p>
    <h3 id="schema-4">
      Schema
    </h3>
    <pre>
{
   "ids" : string array
}
</pre>
    <h3 id="parameters-4">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            ids
          </td>
          <td>
            Yes
          </td>
          <td>
            string array
          </td>
          <td>
            Array of JSON data object IDs.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-4">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Success: <a href="/reference/data-types/db8.html#GetResponse">GetResponse</a><br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>  var id1 = &quot;++HE8X59Y00hoKrF&quot;;
  var id2 = &quot;++HE8X59ZZCfac68&quot;;
  var ids = [id1, id2];
  this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;get&quot;,
        parameters: { &quot;ids&quot;: ids },
        onSuccess: function(e) 
        { 
           Mojo.Log.info(&quot;get success!, e=&quot; + JSON.stringify(e));
           var rs = e.results;
           for (i=0; rs[i] != null; i++)
              Mojo.Log.info(&quot;get #&quot;+ (i+1) +&quot;, id=&quot;+ rs[i]._id+&quot;, displayName=&quot;+rs[i].displayName+&quot;, nickname=&quot;+rs[i].nickname+&quot;, familyName=&quot;+rs[i].name[0].familyName);                       
        },
        onFailure: function(e) { Mojo.Log.info(&quot;get failure! Err = &quot; + JSON.stringify(e));}
 });
</code>
</pre>
    <p>
      <a name="merge" id="merge">&#160;</a>
    </p>
    <hr>
    <h2 id="merge">
      merge
    </h2>
    <p>
      Updates properties in existing objects. Objects can be specified using a query (returns CountResponse) or array of IDs (returns PutResponse).
    </p>
    <h3 id="schema-5">
      Schema
    </h3>
    <pre>
{
   "objects" : any object array,                     
   "query"   : <a href="/reference/data-types/db8.html#Query">Query</a>,
   "props"   : any object
}
</pre>
    <h3 id="parameters-5">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            objects
          </td>
          <td>
            No
          </td>
          <td>
            any object array
          </td>
          <td>
            Array of IDs and properties to update. Either this or &quot;query&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            query
          </td>
          <td>
            No
          </td>
          <td>
            <a href="/reference/data-types/db8.html#Query">Query</a>
          </td>
          <td>
            Query specifying set of objects to merge properties into. Either this or &quot;objects&quot; is required.
          </td>
        </tr>
        <tr>
          <td>
            props
          </td>
          <td>
            No
          </td>
          <td>
            any object
          </td>
          <td>
            Requires &quot;query&quot;. Set of properties to merge into existing object(s) from query.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-5">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Succcess: <a href="/reference/data-types/db8.html#PutResponse">PutResponse</a> (IDs) or <a href="/reference/data-types/db8.html#CountResponse">CountResponse</a> (query)<br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Examples</strong>
    </p>
    <p>
      <strong>Example using IDs</strong>
    </p>
    <pre>
<code>   //** Create objects to update nickname field
   var m1 = {  &quot;_id&quot;: &quot;++HECGnRNNF_7TdA&quot;, &quot;nickname&quot;: &quot;Sugar&quot; };
   var m2 = {  &quot;_id&quot;: &quot;++HECGnRLstE6iwP&quot;, &quot;nickname&quot;: &quot;Swifty&quot; };

   var mobjs = [m1, m2];

   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;merge&quot;,
        parameters: { &quot;objects&quot;: mobjs },
        onSuccess: function(e)        
        { 
           Mojo.Log.info(&quot;merge success!&quot;);
           var results = e.results;
           for (i=0; results[i] != null; i++)
              Mojo.Log.info(&quot;merge #&quot;+i+&quot;  id =&quot;+ results[i].id+&quot;, rev=&quot;+results[i].rev);                       
        },
        onFailure: function(e) { Mojo.Log.info(&quot;merge failure! Err = &quot; + JSON.stringify(e));}
   }); 
</code>
</pre>
    <p>
      <strong>Example using query</strong>
    </p>
    <pre>
<code>   //** Assign a property to update, and create the query
   //** Note that indexes must exist for the fields you are querying on
   //**
   var mprops = { &quot;nickname&quot;:&quot;Spud&quot;};
   var mquery = { &quot;from&quot;:&quot;com.palm.sample:1&quot;,&quot;where&quot;:[{&quot;prop&quot;:&quot;state&quot;,&quot;op&quot;:&quot;%&quot;,&quot;val&quot;:&quot;C&quot;}] };
   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;merge&quot;,
        parameters: { 
                      &quot;query&quot;: mquery,
                      &quot;props&quot;: mprops
                     },
        onSuccess: function(e) { Mojo.Log.info(&quot;merge success!, count= &quot; +e.count);},
        onFailure: function(e) { Mojo.Log.info(&quot;merge failure! Err = &quot; + JSON.stringify(e));}
   });
</code>
</pre>
    <p>
      <a name="put" id="put">&#160;</a>
    </p>
    <hr>
    <h2 id="put">
      put
    </h2>
    <p>
      Puts JSON data objects of a particular <em>kind</em> into the database. Assigns &quot;id&quot; field if not set. Returns &quot;id&quot; and &quot;rev&quot; for each object stored.
    </p>
    <h3 id="schema-6">
      Schema
    </h3>
    <pre>
{
   "objects" : any object array
}
</pre>
    <h3 id="parameters-6">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            objects
          </td>
          <td>
            Yes
          </td>
          <td>
            any object array
          </td>
          <td>
            Array of JSON data objects of a particular kind to store.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-6">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Succcess: <a href="/reference/data-types/db8.html#PutResponse">PutResponse</a><br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>   //** Create new JSON data objects    
   var  contact1 = {
      _kind: &quot;com.palm.sample:1&quot;,
      displayName: &quot;Mabel Syrup&quot;,
      state : &quot;CA&quot;,
      name: [{&quot;familyName&quot;:&quot;Syrup&quot;, &quot;givenName&quot;:&quot;Mabel&quot;}],
      nickname: &quot;Sticky&quot;,
      emails:[
        {&quot;value&quot;:&quot;msyrup@gmail.com&quot;, &quot;type&quot;:&quot;home&quot;},
        {&quot;value&quot;: &quot;mabel.syrup@palm.com&quot;, &quot;type&quot;:&quot;work&quot;}]};

   var  contact2 = {
      _kind: &quot;com.palm.sample:1&quot;,
      displayName: &quot;Helen Wheels&quot;,
      state : &quot;OR&quot;,
      name: [{&quot;familyName&quot;:&quot;Wheels&quot;, &quot;givenName&quot;:&quot;Helen&quot;}],
      nickname: &quot;Speedy&quot;,
      emails:[
        {&quot;value&quot;:&quot;hwheels@gmail.com&quot;, &quot;type&quot;:&quot;home&quot;},
        {&quot;value&quot;: &quot;helen.wheels@palm.com&quot;, &quot;type&quot;:&quot;work&quot;}]};    

   //** Create object array
   var objs = [contact1, contact2];

   //** Call DB service   
   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;put&quot;,
        parameters: { &quot;objects&quot;: objs },
        onSuccess: function(e) 
        { 
           Mojo.Log.info(&quot;put success! e=&quot; + JSON.stringify(e));
           var results = e.results;
           for (i=0; results[i] != null; i++)
              Mojo.Log.info(&quot;put #&quot;+i+&quot;  id =&quot;+ results[i].id+&quot;, rev=&quot;+results[i].rev);                 
        },
        onFailure: function(e) { Mojo.Log.info(&quot;put failure! Err = &quot; + JSON.stringify(e));}
 });
</code>
</pre>
    <p>
      <a name="putKind" id="putKind">&#160;</a>
    </p>
    <hr>
    <h2 id="putkind">
      putKind
    </h2>
    <p>
      Registers a <em>kind</em> JSON object with the database.
    </p>
    <p>
      Kind objects define the owner and indexes for a JSON data object.
    </p>
    <p>
      Your indexes can be composed of single or multiple fields. When you create your index, be aware that queries can only return results that are indexed and are contiguously ordered. See <a href="/dev-guide/mojo/db8.html#fastQueries">All Queries Must be on Indexed Fields</a> for more information.
    </p>
    <p>
      If your app or service wants to be notified only when a subset of an object's properties are updated, then you can use <em>revision sets</em>. See <a href="/dev-guide/mojo/db8.html#UsingRevSets">Using Revision Sets</a> for more information.
    </p>
    <p>
      If your app or service creates objects that other apps or services need to access, then see <a href="/dev-guide/mojo/db8.html#Permissions">Allowing Other Apps or Services to Access Your db8 Data</a> for more information.
    </p>
    <h3 id="syntax">
      Syntax
    </h3>
    <pre>
{
   "id"      : string,
   "owner"   : string,
   "schema"  : <a href="http://json-schema.org/schema">Schema</a>,
   "sync"    : boolean,
   "extends" : string array,
   "indexes" : <a href="/reference/data-types/db8.html#IndexClause">IndexClause</a> array,
   "revSets" : <a href="/reference/data-types/db8.html#RevSetClause">RevSetClause</a> array, 
}
</pre>
    <h3 id="parameters-7">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="500">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            id
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Kind identifier.
          </td>
        </tr>
        <tr>
          <td>
            owner
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Kind ownerâ€”service's bus address or app's app ID. Only the owner has permission to modify the kind.
          </td>
        </tr>
        <tr>
          <td>
            schema
          </td>
          <td>
            No
          </td>
          <td>
            <a href="http://json-schema.org/schema">Schema</a>
          </td>
          <td>
            JSON schema for data objects <em>of this kind</em>. If set, this kind's data objects are validated before being stored.
          </td>
        </tr>
        <tr>
          <td>
            sync
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Backup and restore objects of this kind flag. Objects are backed up to Palm's servers on a daily basis. If the user moves to another device, saved app data can be restored. Default is <code>false</code>.
          </td>
        </tr>
        <tr>
          <td>
            extends
          </td>
          <td>
            No
          </td>
          <td>
            string array
          </td>
          <td>
            IDs of kind parents.
          </td>
        </tr>
        <tr>
          <td>
            indexes
          </td>
          <td>
            No
          </td>
          <td>
            <a href="/reference/data-types/db8.html#IndexClause">IndexClause</a> array
          </td>
          <td>
            Kind indexes.
          </td>
        </tr>
        <tr>
          <td>
            revSets
          </td>
          <td>
            No
          </td>
          <td>
            <a href="/reference/data-types/db8.html#RevSetClause">RevSetClause</a> array
          </td>
          <td>
            Array of revision sets. See <a href="/dev-guide/mojo/db8.html#UsingRevSets">Using Revision Sets</a> for more information.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-7">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Succcess: <a href="/reference/data-types/db8.html#SuccessResponse">SuccessResponse</a><br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>var indexes = [{&quot;name&quot;:&quot;dNameState&quot;, props:[{&quot;name&quot;: &quot;state&quot;}, {&quot;name&quot;:&quot;displayName&quot;}]} ];
   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;putKind&quot;,
        parameters: { &quot;id&quot;:&quot;com.palm.sample:1&quot;, 
                      &quot;owner&quot;:&quot;com.palm.dbtest&quot;,
                      &quot;indexes&quot;: indexes
        },
        onSuccess: function() { Mojo.Log.info(&quot;putKind success!&quot;);},
        onFailure: function(e) { Mojo.Log.info(&quot;putKind failure! Err = &quot; + JSON.stringify(e));}
 });
</code>
</pre>
    <p>
      <a name="reserveIds" id="reserveIds">&#160;</a>
    </p>
    <hr>
    <h2 id="reserveids">
      reserveIds
    </h2>
    <p>
      Reserves a block of object ids.
    </p>
    <h3 id="schema-7">
      Schema
    </h3>
    <pre>
{
   "count" : int        
}
</pre>
    <h3 id="parameters-8">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            count
          </td>
          <td>
            Yes
          </td>
          <td>
            int
          </td>
          <td>
            Number of Ids to reserve.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-8">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Success: <a href="/reference/data-types/db8.html#ReserveIdsResponse">ReserveIdsResponse</a><br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <p>
      Get block of 5 IDs:
    </p>
    <pre>
<code>   var count = 5;
   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
      method: &quot;reserveIds&quot;,
      parameters: { &quot;count&quot;: count  },
      onSuccess: function(e) { 
         Mojo.Log.info(&quot;reserveIds success!&quot;);
         var ids = e.ids;
         for (i=0; i &lt; count; i++)
            Mojo.Log.info(&quot;reserveIds ID #&quot;+(i+1)+&quot; =&quot;+ids[i]);
      },
      onFailure: function(e) { Mojo.Log.info(&quot;delKind failure! Err = &quot; + JSON.stringify(e));}
   }); 
</code>
</pre>
    <p>
      <a name="search" id="search">&#160;</a>
    </p>
    <hr>
    <h2 id="search">
      search
    </h2>
    <p>
      Unlike <a href="#find">find</a>, this call supports the '?' operator, which can be used for full-text searching. Also, ordering by any property is supported. However, this call is significantly slower and should only be used for full-text type-down search; never for retrieving results that are going to be scrolled in a list.
    </p>
    <h3 id="schema-8">
      Schema
    </h3>
    <pre>
{
   "query" : <a href="/reference/data-types/db8.html#Query">Query</a>,
   "watch" : boolean          
}
</pre>
    <h3 id="parameters-9">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            query
          </td>
          <td>
            Yes
          </td>
          <td>
            <a href="/reference/data-types/db8.html#Query">Query</a>
          </td>
          <td>
            Query for search.
          </td>
        </tr>
        <tr>
          <td>
            watch
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Notify if change flag. Default is false.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-9">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tbody>
        <tr>
          <td width="100">
            Response
          </td>
          <td>
            Succcess: <a href="/reference/data-types/db8.html#FindResponse">FindResponse</a> or <a href="/reference/data-types/db8.html#NotificationResponse">NotificationResponse</a><br>
            (watch == true)<br>
            Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>   var fquery = {&quot;from&quot;:&quot;com.palm.searchtest:1&quot;,&quot;orderBy&quot;:&quot;foo&quot;,&quot;where&quot;:[{&quot;prop&quot;:&quot;foo&quot;,&quot;op&quot;:&quot;?&quot;,&quot;val&quot;:&quot;fo&quot;,&quot;collate&quot;:&quot;primary&quot;}]};

   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;search&quot;,
        parameters: { &quot;query&quot;: fquery},
        onSuccess: function(e) { Mojo.Log.info(&quot;Search success, results= &quot; + JSON.stringify(e));},
        onFailure: function(e) { Mojo.Log.info(&quot;Search failure! Err = &quot; + JSON.stringify(e));}
   }); 
</code>
</pre>
    <p>
      <a name="watch" id="watch">&#160;</a>
    </p>
    <hr>
    <h2 id="watch">
      watch
    </h2>
    <p>
      Watch for updates to database that would change the results of a query.
    </p>
    <h3 id="schema-9">
      Schema
    </h3>
    <pre>
{
   "query" : <a href="/reference/data-types/db8.html#Query">Query</a>        
}
</pre>
    <h3 id="parameters-10">
      Parameters
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="tan">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            query
          </td>
          <td>
            Yes
          </td>
          <td>
            <a href="/reference/data-types/db8.html#Query">Query</a>
          </td>
          <td>
            Query whose results should be watched.
          </td>
        </tr>
      </tbody>
    </table>
    <h3 id="returns-10">
      Returns
    </h3>
    <table border="1" cellpadding="5" cellspacing="5">
      <tr>
        <td width="100">
          Response
        </td>
        <td>
          Succcess: <a href="/reference/data-types/db8.html#SuccessResponse">SuccessResponse</a> or<br>
          <a href="/reference/data-types/db8.html#NotificationResponse">NotificationResponse</a><br>
          Failure: <a href="/reference/data-types/db8.html#ErrResponse">ErrResponse</a>
        </td>
      </tr>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <p>
      Query on a revision set field. See <a href="/dev-guide/mojo/db8.html#using-revision-sets">Using Revision Sets</a> for more information.
    </p>
    <pre>
<code>   var fquery = {&quot;from&quot;:&quot;com.palm.sample:1&quot;, &quot;where&quot;:[{&quot;prop&quot;:&quot;stateRev&quot;,&quot;op&quot;:&quot;&gt;&quot;,&quot;val&quot;:4881}]};

   this.controller.serviceRequest(&quot;palm://com.palm.db/&quot;, {
        method: &quot;watch&quot;,
        parameters: { &quot;query&quot;: fquery},
        onSuccess: function(e) 
        { 
           if (!e.fired)
              Mojo.Log.info(&quot;RevSet watch initial response success, results= &quot; + JSON.stringify(e));
           else
              Mojo.Log.info(&quot;RevSet watch results changed&quot;);
        },
        onFailure: function(e) { Mojo.Log.info(&quot;RevSet watch failure! Err = &quot; + JSON.stringify(e));}
   });
</code>
</pre>
		</div>
	</body>
</html>